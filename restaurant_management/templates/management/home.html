{% extends "management/layout.html" %}
{% load bootstrap5 %}
{% block title %} {% endblock %}

{% block content %}
{% bootstrap_css %}
{% bootstrap_javascript %}

<div class="container">
        <!-- Phần này cho danh sách bàn và menu -->
        <div id="container_1">
              <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                  <button class="nav-link active"  data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Danh Sách Bàn</button>
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Menu</button>
                </div>
              </nav>
              <div class="tab-content" id="nav-tabContent">
                    <!-- Content Danh sách bàn -->
                    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <div class="btn_matrix" role="group" aria-label="Three Column Button Matrix">
                            <form action="" method="post">
                            {% for ban in bans %}
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-outline-primary btn_ban" value='{{ban.so_ban}}' name = "choose_ban">
                                        Bàn số    : {{ban.so_ban}} <br>
                                        Trạng thái: {{ban.trang_thai}}
                                    </button>
                            {% endfor %}
                            </form>
                            
                          </div>
                    </div>
                    <!-- Content cho danh sách thực đơn -->
                    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                      <nav>
                        <div class="nav nav-tabs" id="nav-tab" role="tablist">
                          <button class="nav-link active"  data-bs-toggle="tab" data-bs-target="#nav-menu1" type="button" role="tab" aria-controls="nav-menu1" aria-selected="true">Menu 1</button>
                          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-menu2" type="button" role="tab" aria-controls="nav-menu2" aria-selected="false">Menu 2</button>
                          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-menu3" type="button" role="tab" aria-controls="nav-menu3" aria-selected="false">Menu 3</button>
                          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-menu4" type="button" role="tab" aria-controls="nav-menu4" aria-selected="false">Menu 4</button>
                        </div>
                      </nav>
                      <div class="tab-content" id="nav-tabMenuContent">
                        <div class="tab-pane fade show active" id="nav-menu1" role="tabpanel" aria-labelledby="nav-menu1-tab">
                          Số bàn : {{so_ban}}

                            <table class="table" >
                                <thead>
                                  <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Tên</th>
                                    <th scope="col">Đơn vị</th>
                                    <th scope="col">Giá</th>
                                    <th scope="col">#</th>
                                  </tr>
                                </thead>
                            </table>
                                <div style="height: 550px; overflow:auto;">
                                  <table class="table">
                                    <tbody>
                                    {% for mon in menu1 %}
                                    <tr>
                  
                                        <td></td>
                                        <td>{{mon.ten_mon}}</td>
                                        <td>{{mon.don_vi}}</td>
                                        <td>{{mon.gia}}</td>
                                        <td>
                                          
                                            <button id="addMeal{{mon.ten_mon}}" onclick="addMealFunction('{{mon.ma_mon}}', '{{mon.ten_mon}}', '{{mon.gia}}')" class= "add_mon" >Add</button>
                                          
                                        </td>
                                      </tr>      
                                    {% endfor %}
                                    </tbody>
                                  </table>
                                </div>
                        </div>
                              <div class="tab-pane fade" id="nav-menu2" role="tabpanel" aria-labelledby="nav-menu2-tab">
                                Số bàn : {{so_ban}}

                                <table class="table" >
                                    <thead>
                                      <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Tên</th>
                                        <th scope="col">Đơn vị</th>
                                        <th scope="col">Giá</th>
                                        <th scope="col">#</th>
                                      </tr>
                                    </thead>
                                </table>
                                    <div style="height: 550px; overflow:auto;">
                                      <table class="table">
                                        <tbody>
                                        {% for mon in menu2 %}
                                        <tr>
                      
                                            <td></td>
                                            <td>{{mon.ten_mon}}</td>
                                            <td>{{mon.don_vi}}</td>
                                            <td>{{mon.gia}}</td>
                                            <td>
                                              
                                                <button id="addMeal{{mon.ten_mon}}" onclick="addMealFunction('{{mon.ma_mon}}', '{{mon.ten_mon}}', '{{mon.gia}}')" class= "add_mon" >Add</button>
                                              
                                            </td>
                                          </tr>      
                                        {% endfor %}
                                        </tbody>
                                      </table>
                                    </div>
                              </div>
                              <div class="tab-pane fade" id="nav-menu3" role="tabpanel" aria-labelledby="nav-menu3-tab">
                                Số bàn : {{so_ban}}

                                <table class="table" >
                                    <thead>
                                      <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Tên</th>
                                        <th scope="col">Đơn vị</th>
                                        <th scope="col">Giá</th>
                                        <th scope="col">#</th>
                                      </tr>
                                    </thead>
                                </table>
                                    <div style="height: 550px; overflow:auto;">
                                      <table class="table">
                                        <tbody>
                                        {% for mon in menu3 %}
                                        <tr>
                      
                                            <td></td>
                                            <td>{{mon.ten_mon}}</td>
                                            <td>{{mon.don_vi}}</td>
                                            <td>{{mon.gia}}</td>
                                            <td>
                                              
                                                <button id="addMeal{{mon.ten_mon}}" onclick="addMealFunction('{{mon.ma_mon}}', '{{mon.ten_mon}}', '{{mon.gia}}')" class= "add_mon" >Add</button>
                                              
                                            </td>
                                          </tr>      
                                        {% endfor %}
                                        </tbody>
                                      </table>
                                    </div>
                              </div>
                              <div class="tab-pane fade" id="nav-menu4" role="tabpanel" aria-labelledby="nav-menu4-tab">
                                Số bàn : {{so_ban}}

                                <table class="table" >
                                    <thead>
                                      <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Tên</th>
                                        <th scope="col">Đơn vị</th>
                                        <th scope="col">Giá</th>
                                        <th scope="col">#</th>
                                      </tr>
                                    </thead>
                                </table>
                                    <div style="height: 550px; overflow:auto;">
                                      <table class="table">
                                        <tbody>
                                        {% for mon in menu4 %}
                                        <tr>
                      
                                            <td></td>
                                            <td>{{mon.ten_mon}}</td>
                                            <td>{{mon.don_vi}}</td>
                                            <td>{{mon.gia}}</td>
                                            <td>
                                              
                                                <button id="addMeal{{mon.ten_mon}}" onclick="addMealFunction('{{mon.ma_mon}}', '{{mon.ten_mon}}', '{{mon.gia}}')" class= "add_mon" >Add</button>
                                              
                                            </td>
                                          </tr>      
                                        {% endfor %}
                                        </tbody>
                                      </table>
                              </div>
                          </div>
                         {% comment %} </form>  {% endcomment %}
                    </div>
              </div>
            </div>
        </div>
        <!-- Phần này cho Hóa đơn -->
        
        <div id="container_2">
          <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
              <button class="nav-link active"  data-bs-toggle="tab" data-bs-target="#nav-home-bill" type="button" role="tab" aria-controls="nav-home-bill" aria-selected="true">Hóa đơn</button>
              <button class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-home-booking" type="button" role="tab" aria-controls="nav-home-booking" aria-selected="false">Lịch đặt</button>
            </div>
          </nav>
          <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-home-bill" role="tabpanel" aria-labelledby="nav-home-bill-tab">
            
            
              <form name="homeForm" action="" method="post">
                  <p>Số bàn : {{so_ban}} </p>
                  <p>Mã hóa đơn : {{hoadon.ma_hoa_don}}</p>
                  <p>Thông tin khách hàng:<input  name="thong_tin_khach_hang" type="text " value="{{thongtinkhachhang}}">
                    <button type="submit" value='{{so_ban}}' name="search_infor_kh" id= "search">Search</button>
                  </p>
                  <p>Họ tên của khách hàng:{{hotenkhachhang}}</p>
                  <p>Tiền tích lũy của khách hàng:{{tientichluy}}</p>
                  <p>Tiêu tích lũy:<input  name="so_diem_tieu" type="text " value="0">
                  <button type="submit" value='{{so_ban}}' name="tieu_tich_luy" id="use">Use</button>
                  </p>
                  {% csrf_token %}
                  <table class="table">
                      <thead>
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Tên</th>
                          <th scope="col">Số lượng</th>
                          <th scope="col"> Đơn Giá </th>
                          <th scope="col">Thành tiền</th>
                          <th scope="col">#</th>
                        </tr>
                      </thead>
                  </table>    
                  <div style="height: 150px; overflow:auto;">
                    <table class="table">
                      <tbody id="bang_hoa_don">
                      {% for dat_mon in dat_mons %}
                       <tr >
                          <td></td>
                          <td class="ten__mon">{{dat_mon.get_ten_mon}}</td>
                          <td class="so__luong">{{dat_mon.so_luong}}</td>
                          <td class="gia__mon">{{dat_mon.get_gia}}</td>
                          <td class="thanh__tien"> {{dat_mon.thanh_tien}}</td>
                          <td></td>
                      </tr>  
                      {% endfor %}                      
                        <!-- if else -->
                    </tbody>
                    </table>
                  </div>
                    <table class="table">
                      <tfoot>
                        <tr>
                          <th colspan="6">Khuyến mãi</th>
                        </tr>
                        <tr>
                          <th></th>
                          <th>Món</th>
                          <th colspan="2">Sự kiện</th>
                          <th>Thành tiền</th>
                        </tr>
                        {% for event in events %}
                          <tr>
                              <td></td>
                              <td>{{event.ma_mon}}</td>
                              <td colspan="2">{{event.ten_sk}}</td>
                              <td>0</td>
                          </tr>
                        {% endfor %}
                        <tr>
                          <th scope="row"></th>
                          <td></td>
                          <td></td>
                          <td class="tong_tien">Tổng tiền: </td>
                          <td class="total">{{hoadon.don_gia}}</td>
                          <th></th>
                        </tr>
  
                      </tfoot>
                  </table>
                  <button type="submit" value='{{so_ban}}' name="add_hoa_don" id="luuhoadon1">Lưu hóa đơn</button>
                  <button onclick = "deletebill() " type="submit" value='{{hoadon.ma_hoa_don}}' name="remove_hoa_don" id="xoahoadon1">Xóa hóa đơn</button>
                  <button type="submit" value='{{hoadon.ma_hoa_don}}' name="pay_hoa_don" id="thanhtoan1">Thanh toán</button>
              </form>
            </div>
            <div class="tab-pane fade " id="nav-home-booking" role="tabpanel" aria-labelledby="nav-home-booking-tab">
              
              {% comment %} <form action="" method="post"> {% endcomment %}
                  Số bàn : {{so_ban}}
                  {% csrf_token %}
                  <table class="table">
                      <thead>
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Họ tên</th>
                          <th scope="col">Số điện thoại</th>
                          <th scope="col"> Số bàn </th>
                          <th scope="col">Thời gian</th>
                          <th scope="col">#</th>
                        </tr>
                      </thead>
                      <tbody id="bang_hoa_don">
                        {% for dat_ban in dat_bans %}
                       <tr >
                          <th scope="row"></th>
                          <td class="ho_ten">{{dat_ban.ho_ten}}</td>
                          <td class="sdt">{{dat_ban.sdt}}</td>
                          <td class="so_ban">{{dat_ban.so_ban.so_ban}}</td>
                          <td class="thoi_gian"> {{dat_ban.thoi_gian}}</td>
                      </tr>   
                      {% endfor %}       
                        <!-- if else
                       <tr >
                          <th scope="row"></th>
                          <td class="ho_ten"><input name="ho_ten" type="text"  /></td>
                          <td class="sdt"><input name="sdt" type="text"  /></td>
                          <td class="so_ban">{{so_ban}}</td>
                          <td class="thoi_gian"><input name="thoi_gian" type="text"  /> </td>
                          <th></th>
                      </tr>  -->
                      </tbody>
                  </table>
                  
                  
              {% comment %} </form>   {% endcomment %}

            </div>
          </div>
              
        </div>


  </div>
  <script>
    var soban= document.homeForm.add_hoa_don.value;
    var mahoadon= document.homeForm.remove_hoa_don.value;
    var ttkh= document.homeForm.thong_tin_khach_hang.value;
    if(soban== null || soban ==""){
      document.getElementById("xoahoadon1").disabled= true;
      document.getElementById("thanhtoan1").disabled= true;
      document.getElementById("luuhoadon1").disabled= true;
      document.getElementById("search").disabled= true;
    }else if(mahoadon== null || mahoadon == ""){
      document.getElementById("xoahoadon1").disabled= true;
      document.getElementById("thanhtoan1").disabled= true;
      document.getElementById("search").disabled= true;
    }
    if(ttkh==null || ttkh==""){
      document.getElementById("use").disabled= true;
    }
  </script>
{% endblock %}